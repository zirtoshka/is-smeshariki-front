<app-back-button [isFeed]="isFeed" (goBackEvent)="handleGoBack()"> назад</app-back-button>

<nz-card class="post-card" [nzBordered]="true" [nzHoverable]="true">
  <nz-card-meta
    [nzTitle]="title"
    [nzDescription]="nzDescription"
    [nzAvatar]="avatarTemplate">
  </nz-card-meta>
  <br>
  <div class="post-tag" *ngIf="!isFeed">
    <app-post-tag [isDraft]="post.isDraft" [isPrivate]="post.isPrivate"></app-post-tag>
  </div>


  <div class="post-content">
    <p class="post-text">{{ post.text }}</p>
    <img
      *ngIf="post.pathToImage"
      [src]="post.pathToImage"
      alt="Изображение поста"
      class="post-image"
    />
  </div>


  <div class="post-carrots">
    <i
      nz-icon
      [nzType]="iconCarrot.name"
      class="large-icon"
      [class.liked]="isLiked"
      (click)="toggleLike()"
    ></i>
    <app-carrot-count [postId]="post.id"></app-carrot-count>
  </div>


  <div class="comment-toggle" *ngIf="isCommentExisted">
    <i (click)="toggleComments()">
      {{ isCommentsVisible ? 'скрыть комментарии' : 'показать комментарии' }}
    </i>
  </div>

  <div class="comment-toggle" *ngIf="!isCommentExisted">
    комментариев нема
  </div>

  <app-nested-comm *ngIf="isCommentsVisible"
                   [groupedComments]="commentService.groupComments(this.commentsList)"></app-nested-comm>

</nz-card>

<ng-template #avatarTemplate>
  <nz-avatar
    [style.background-color]="post.smesharikAuthor?.color"
    nzSize="large"
    nzIcon="user"
  >
  </nz-avatar>
</ng-template>

<ng-template #nzDescription>
  <p class="item-date">
    <i nz-icon nzType="calendar" nzTheme="outline"></i>
    опубликовано: {{ this.dateFormatterService.formatDate(post.publicationDate) }} <br>
  </p>
</ng-template>


<ng-template #title>
  {{post.smesharikAuthor?.name}}
  {{post.author}}
  {{post.id}}
</ng-template>
